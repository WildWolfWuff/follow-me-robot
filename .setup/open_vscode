used_shell=${SHELL##*/}
. ./func/func.${used_shell}

workspace=${PWD%/*}
while getopts ":hw:" opt; do
    case $opt in
        w) 
           workspace="${OPTARG}"
           printInfo "use workspace $workspace"
        ;;
        ?|h)
            printText "Usage: $(basename $0) [-w workspace] [-h]"
            exit 1
        ;;
    esac
done

printStep "Install vs code extensions"

code --help > /dev/null
if [ $? -ne 0 ]; then
	sudo snap install --classic code
fi
jq -h > /dev/null
if [ $? -ne 0 ]; then
	sudo apt update && sudo sudo apt install -y jq
fi
extensions=$(jq -r '.recommendations[]' $workspace/.vscode/extensions.json)
for i in $extensions; do
    code --install-extension $i --force &
done
wait
code $workspace

used_shell=${SHELL##*/}
. ./func/func.${used_shell}

workspace=${PWD%/*}
install_code=false
echo $workspace
while getopts ":hcw:" opt; do
    case $opt in
        w) 
           workspace="${OPTARG}"
           printInfo "use workspace $workspace"
        ;;
        ?|h)
            printText "Usage: $(basename $0) [-w workspace] [-h]"
            exit 1
        ;;
    esac
done


code --help > /dev/null
if [ $? -ne 0 ]; then
    printStep "Install vs code"
	sudo snap install --classic code
fi
jq -h > /dev/null
if [ $? -ne 0 ]; then
    printStep "Install jq"
	sudo apt update && sudo sudo apt install -y jq
fi
printStep "Install vs code extensions"
extensions=$(jq -r '.recommendations[]' $workspace/.vscode/extensions.json)
for i in $extensions; do
    code --install-extension $i --force
done
code $workspace
